# EDA To Do

- [X] 1. Train에서 공급유형이 `장기전세`, `공공분양`, `공공임대(5년)`인 example들의 `단지코드`가 차지하는 비율 살펴보기
    > 이 공급 유형들이 **Test 에 나타나지 않는다**는 점과 **전체 example 중 0.7 %**, 특히 이들을 **제거해도 전제 단지코드 중 0.34 % 의 단지코드만이 사라진다**는 점을 감안하면, 이들을 **제거하여 성능 평가를 해보는 것도 좋을 것** 같다.
- [X] 2. 하나의 단지코드내에 `임대건물구분` 값 존재 양상(상가/아파트/상가&아파트)에 따른 `등록차량수` 살펴보기
    > `주상복합`일 때 주차 수요가 더 높을 것이라는 예상은 옳지 못하다.

    > '아파트'일 때와 '상가&아파트'일 때 2가지 경우로 LabelEncoding하는 것이 더 좋아보인다.

    > 단, '아파트'일 때의 주차 수요가 더 높았으므로 `'아파트'-> 1, '상가&아파트' -> 0` 으로 매핑해보자!
- [X] 3. `자격유형`별로 `임대보증금`과 `임대료`의 평균값들을 계산하여 소득수준과 관련한 판단 지표가 될 수 있는 지 확인하기.
    > **`'자격유형별 평균 임대료'`를 feature로 이용하여 성능평가를 해보는 것도 좋아보인다.**

# Preprocess Idea

## 1. Train에서 공급유형이 `장기전세`, `공공분양`, `공공임대(5년)`인 example에 대한 처리방안
- [ ] **아예 Drop 한다.**
    > 이유 : Test 에서는 존재하지 않는 유형들이며, Train에서도 차지하는 비율이 높지 않다.

    > 의문점 :  공급유형 중 몇 가지를 아예 배제하는 것은 바람직한 모델링이 아니지 않을까..?

- [ ] **다른 비슷한 유형과 병합한다.**
    > 이유 : 아예 삭제하는 것이 좋지 않다면, 비슷한 유형인 것들 끼리 그룹을 지어서 하나의 유형으로 만들면 되지 않을까?
    - `공공임대(5년)`과 `공공분양`은 기존의 `공공임대(10년)`, `공공임대(50년)`, `공공임대(분납)` 과 모두 병합하여 하나의 feature인 `공공임대(5년/10년/50년/분납/분양)`으로 만들 수 있다. 
    - `장기전세`는 `국민임대`와 병합하여 `국민임대/장기전세`로 만들 수 있다.

    > 의문점 : 국민임대는 왜 장기전세랑 그룹을 만들까..?

---

## 2. 단지코드내에 `임대건물구분` 처리방안
- [ ] **상가와 아파트 둘 다 존재할 경우, 더 많이 존재하는 값으로 단지코드를 대표한다.**
- [ ] ~~**임대건물구분 값들을 feature로 올려서 유형 존재 유무 표기**~~
    > '상가'만 존재하는 경우는 없기 때문에 군디 feature로 올려서 sparse하게 만들 필요가 없어보인다.
- [ ] **'아파트'일 때 1, '상가&아파트'일 떄 0으로 LabelEncoding한다.**

---

## 3. 자격유형 별 feature 추가 여부

- [ ] ~~**소득 분위를 간접적으로 명시할 수 있도록 단지코드별 임대보증금과 임대료의 `평균값`을 feature로 추가한다.**~~
    > 평균 임대보증금은 등록차량수와 다소 그 양상의 차이를 보인다. 따라서 '평균 임대료'만 feature로 추가해보자.
- [ ] **소득 분위를 간접적으로 명시할 수 있도록 단지코드별 임대료의 `평균값`을 feature로 추가한다.**
- [ ] **소득을 확인할 수 있도록 하는 feature를 추가하지 않는다.**

# EDA Result Summary

## 1. `단지 코드` 별 집계

### [하나의 단지 코드 내에서 Unique값 확인]

~~~python
train.groupby(['단지코드']).nunique(dropna=False)
~~~

- 위와 같이 train data를 `단지코드`를 기준으로 그룹화하여 그룹내의 Unique값 개수를 세어 하나의 단지코드 내에서 모두 같은 값을 가지는 feature와 그렇지 않은 feature를 구분.

#### 단지코드 내에서 모두 같은 값을 가지는 feature

- '총세대수', '지역', '공가수', '도보 10분거리 내 지하철역 수(환승노선 수 반영)', '도보 10분거리 내 버스정류장 수', '단지내주차면수', '등록차량수'
- target으로 사용할 `등록차량수`를 제외하면, `6개의 feature`
    - 즉, **`같은 단지코드`는 `같은 등록차량수(target)`을 가진다.**

#### 단지코드 내에서 2개 이상의 Unique값을 가지는 feature

- '임대건물구분', '공급유형', '전용면적', '전용면적별세대수', '자격유형', '임대보증금', '임대료'
- `7개의 feature`
---
### [2개 이상의 Unique값을 가지는 feature 처리]

#### **1. 임대건물구분**

Idea : `주상복합`의 경우, `오직 주거`인 경우 보다 주차수요가 많지 않을까?
> 상가 직원 및 방문 객에 대한 주차 수요가 존재한다면, 일반 가구보다 주차수요가 높아질 것.

- 임대건물구분 feature는 2가지 값을 가진다.
    - '상가', '아파트'
- 임대건물구분이 `상가`일 경우, `전용면적별세대수`는 모두 1이다.
- 임대건물구분의 각 값을 column으로 올려서 주상복합인지 아닌지 구분할 수 있도록 만들자.
    - 임대건물구분이 `상가`인 example과 `아파트`인 example이 모두 있는 단지코드는 `주상복합단지` 이지 않을까?
        - **하나의 단지코드내에 `임대건물구분` 값 존재 양상(상가/아파트/상가&아파트)에 따른 `등록차량수`를 살펴봐야할 것 같다.**

#### **2. 공급유형**

- 공급유형 feature는 10가지 값을 가진다.
    - '국민임대', '임대상가', '공공임대(5년)', '공공임대(10년)', '공공임대(50년)', '공공임대(분납)', '행복주택', '영구임대', '장기전세', '공공분양'
    - 이 중 `장기전세`, `공공분양`, `공공임대(5년)`은 test 데이터에는 존재하지 않는다.
        - train data에서도 data의 비율이 현격이 적다. (3가지 경우인 example이 차지하는 비율을 모두 합해도 0.7% 이다.)
            - **3가지 경우의 example들인 example들이 존재하는 `단지코드`의 비율을 살펴봐야할 것 같다**
- `국민임대`와 `공공임대`의 차이점
    - `국민임대`
    > 저렴한 임대료를 지불하고 장기(30년) 임대가 가능하다. 장기 거주는 가능하지만 해당 주거지를 매입할 수 없다는 단점이 있다.
    
    - `공공임대`
    > 5년 또는 10년 후 임대기간이 종료되었을 때 입주자에게 우선 분양전환혜택을 준다.

#### **3. 자격유형**

Idea : `자격유형` 값 분포에 따라 `등록차량수`에 밀접한 관련이 있을 것이다.
> 특정 자격 유형 값이 많이 분포한다면, 그 단지는 등록차량수가 적을 것이다.

> 예를 들어, 소득수준이 낮은 자격유형의 세대가 많으면, 주차수요가 적을 가능성이 높다고 예상할 수 있다.

- 자격유형에 대한 소득수준을 알 수 있는 feature가 존재하지 않는다.
    - **이를 간접적으로 파악하기 위해 `임대보증금의 평균`과 `임대료의 평균`을 feature로 고려해볼 수 있을 것이다.**
- 자격유형은 `15개`의 값을 가진다.
    - 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P'
    - 이 중 `B`, `F`, `O`는 Train 에만 존재한다.
- Domain 지식을 도입 -> 공급대상 소득분위를 바탕으로 분석해볼 수 있다.
    - 공공임대주택 공급대상
        - 영구임대 : 생계급여 또는 의료급여 수급자 등 [소득 1분위] - 1가지
        - 국민임대 : 무주택세대구성원 [소득 2~4분위] - 3가지
        - 장기전세 : 무주택세대구성원 [소득 3~4분위] - 2가지
        - 공공임대(5년/10년/분납) : 무주택세대구성원 [소득 3~5분위] - 3가지
        - 행복주택 : 무주택세대구성원/무주택자[소득 2~5분위] - 4가지
        > 이렇게 나누면 총 13개 항목 -> 하지만 자격유형은 15개 항목이다.
    - 공급유형 별로 자격 유형을 어떤 것을 가지고 있는 지 확인해보자.
        - `국민임대/장기전세`
            - A : 1524
            - H : 154
            - E : 34
            - B : 18
            - G : 9
        - `영구임대`
            - C : 92
            - I : 49
            - E : 3
            - F : 3
            - A : 2
        - `공공임대(5년/10년/분납/분양)`
            - A : 218
            - D : 7
        - `행복주택`
            - J : 105
            - K : 33
            - L : 33
            - N : 29
            - M : 2
            - O : 1
            >  **`J, K, L, N, M, O`의 6가지 항목은 공급유형이 `행복주택`일 때에만 나타난다. -> 하나로 묶어주는 것이 좋아보인다.**
---

