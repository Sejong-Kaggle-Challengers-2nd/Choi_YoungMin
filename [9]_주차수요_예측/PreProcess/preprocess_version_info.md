# Preprocessing Version Info

## Version 1

### [전처리 목록]
> 적용된 방안은 체크 되었음.

1. Dacon Competition에서 제공한 Baseline Model 설계 시 사용한 전처리 기법
    - **feature 이름** 변경
        - [X] '도보 10분거리 내 지하철역 수(환승노선 수 반영)' -> '지하철'
        - [X] '도보 10분거리 내 버스정류장 수' -> '버스'
    - **지역**
        - [X] 숫자로 매핑
    - **전용면적** 
        - [X] 5의 배수로 변경
        - [X] 상/하한선 적용 (상한 100 / 하한 15)
    - **단지코드** 별 취합방안
        - [X] 각 단지 코드 내에서 **모두 같은 값을 가지는 feature**만 이용하여 병합
            - '단지코드', '총세대수', '공가수', '지역', '단지내주차면수', '지하철', '버스'
    - **전용면적**, **전용면적별세대수**
        - [X] 전용면적 값을 feature로 추가
            - 같은 전용면적 값을 가지는 세대수를 세어 이를 각 전용면적 feature에 대한 값으로 설정한다.

### [전처리 내용 요약]

1. **지역**명 숫자 매핑
2. **전용면적** -> 5의 배수 + 상/하한선 적용
3. **단지코드** 별로 모두 같은 값을 가지는 feature만 이용

### [성능 평가]

> Model : RandomForestRegressor (Baseline Model)

| 구분 | 성능 점수(MAE) |
| :--: | :-----------: |
| LB | 125.0751020408 |

---

## Version 2

### [전처리 내용 요약]

> `Version 1`에서 달라진 내용

1. Baseline 에서 사용한 전처리 이용하지 않음.
2. 임대보증금, 임대료 -> `'-'` NULL로 바꾸기.
3. NULL 값처리
    - 임대보증금, 임대료, 지하철, 버스 -> 0으로 채우기
    - 자격유형 -> C2411 : A / C2253 : C 로 채우기
4. 중복되는 example 제거
5. 단지 코드 별 취합 방안
    - '임대건물구분' : 각 값을 feature로 사용
    - '공급유형' : 비슷한 유형 병합
    - '자격유형' : 각 공급유형 별 자격유형을 파악하여 병합, feature로 올려서 사용
6. 지역 feature를 제거

### [성능 평가]

> Model : RandomForestRegressor (Baseline Model)

| 구분 | 성능 점수(MAE) |
| :--: | :-----------: |
| LB | 127.9244897959 |

---

## Version 3

### [전처리 내용 요약]

> `Version 2`에서 달라진 내용

1. 사용되지 않았던 Baseline(Version 1)의 전처리 중 다음 2 가지를 적용함.
    - 지역명 숫자로 매핑
    - 전용면적 5의 배수로 변경
2. Version 2에서 사라진 전처리 방안
    - 임대건물구분의 각 값을 column으로 올리기 ('임대건물구분_상가', '임대건물구분_아파트')
    - 지역을 아예 Drop하여 사용하지 않기
3. Versoin 3에서 새로 추가된 전처리 방안
    - Trian에서 공급유형이 장기전세, 공공분양, 공공임대(5년)인 example을 아예 Drop한다.
    - 각 단지코드 내에 이 feature 값이 '아파트'만 존재하면 1을, '아파트'와 '상가'가 모두 존재하면 0으로 매핑한다.
    - 자격유형별 평균 임대료 feature 추가

### [성능 평가]

> Model : RandomForestRegressor (Baseline Model)

| 구분 | 성능 점수(MAE) |
| :--: | :-----------: |
| LB | 121.0857142857 |

---

## Version 4

### [전처리 내용 요약]

> `Version 3`에서 달라진 내용

1. `age_gender_info`를 Train과 Test에 추가하여 학습 및 추론.
    - 각 지역 별 가장 많이 거주하는 상위 3 그룹의 '나이대'와 '성별'을 추가

### [성능 평가]

> Model : RandomForestRegressor (Baseline Model)

| 구분 | 성능 점수(MAE) |
| :--: | :-----------: |
| CV | -129.66053879429143 (neg_mae) |
| LB | 119.2285714286 |

> Model : Lasso

| 구분 | 성능 점수(MAE) |
| :--: | :-----------: |
| CV | -128.2108916930039 |
| LB | 111.210051649 |

---

## 전체 전처리 목록
> 적용된 방안은 체크 되었음.

1. Dacon Competition에서 제공한 Baseline Model 설계 시 사용한 전처리 기법
    - **feature 이름** 변경
        - [ ] '도보 10분거리 내 지하철역 수(환승노선 수 반영)' -> '지하철'
        - [ ] '도보 10분거리 내 버스정류장 수' -> '버스'
    - **지역**
        - [X] 숫자로 매핑
    - **전용면적** 
        - [X] 5의 배수로 변경
        - [ ] 상/하한선 적용 (상한 100 / 하한 15)
    - **단지코드** 별 취합방안
        - [X] 각 단지 코드 내에서 **모두 같은 값을 가지는 feature**만 이용하여 병합
            - '단지코드', '총세대수', '공가수', '지역', '단지내주차면수', '지하철', '버스'
    - **전용면적**, **전용면적별세대수**
        - [ ] 전용면적 값을 feature로 추가
            - 같은 전용면적 값을 가지는 세대수를 세어 이를 각 전용면적 feature에 대한 값으로 설정한다.

2. [주차수요 예측 EDA & Catboost Baseline(LB: 118.6101)](https://dacon.io/competitions/official/235745/codeshare/2851?page=1&dtype=recent) 에서 소개된 전처리 기법
    - **임대보증금**, **임대료**
        - [X] 존재하는 `'-'` 값을 NULL로 설정 + dtype을 float로 변경
    - **NULL** 값 처리
        - 임대보증금, 임대료
            - [X] 0 으로 채우기
        - 지하철, 버스
            - [X] 0으로 채우기
        - 자격유형
            - [X] C2411에 존재하는 NULL -> 'A'로 채우기
            - [X] C2253에 존재하는 NULL -> 'C'로 채우기
    - **중복 값** 처리
        - [X] `drop_duplicate()`로 제거하기
    - **단지코드** 별 취합방안
        - 단지코드 내에서 같은 값을 가지는 feature
            - '총세대수', '지역', '공가수', '지하철', '버스', '단지내주차면수', '등록차량수'
            - [X] `drop_duplicate()`로 단일값만 남기기
        - 단지코드 내에서 여러 값을 가지는 feature
            - '임대건물구분', '공급유형', '전용면적', '전용면적별세대수', '자격유형', '임대보증금', '임대료'
            - `임대건물구분`
                - [ ] 임대건물구분의 각 값을 column으로 올리기 ('임대건물구분_상가', '임대건물구분_아파트')
            - `공급유형`
                - [X] '공공임대(5년)', '공공분양', '공공임대(10년)', '공공임대(분납)' -> '공공임대(5년/10년/분납/분양)'
                - [X] '장기전세', '국민임대' -> '국민임대/장기전세'
            - `자격유형`
                - [X] 'J', 'L', 'K', 'N', 'M', 'O' -> '행복주택_공급대상'
                - [X] 'H', 'B', 'E', 'G' -> '국민임대/장기전세_공급대상'
                    > `Version 3`에서 `장기전세` feature를 drop하면서 feature이름이 '국민임대_공급대상'으로 바뀌었음
                - [X] 'C', 'I', 'F' -> '영구임대_공급대상'
                - [X] 각 자격유형 값을 feature로 올려서 사용하기

3. 개인적으로 적용한 전처리 기법
    - **지역**
        - [ ] 아예 Drop하여 사용하지 않기
    - **공급유형**
        - [X] Trian에서 공급유형이 장기전세, 공공분양, 공공임대(5년)인 example을 아예 Drop한다.
    - **임대건물구분**
        - [X] 각 단지코드 내에 이 feature 값이 '아파트'만 존재하면 1을, '아파트'와 '상가'가 모두 존재하면 0으로 매핑한다.
    - **새로운 feature 추가**
        - [X] 자격유형별 평균 임대료 feature 추가
    - **age_gender_info**
        - [X] 각 지역 별 가장 많이 거주하는 상위 3 그룹의 '나이대'와 '성별'을 추가